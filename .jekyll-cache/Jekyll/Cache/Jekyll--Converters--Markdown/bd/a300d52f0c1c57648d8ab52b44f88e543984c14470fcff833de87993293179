I"!<h2 id="configuração-do-banco-de-dados-postgresql-production">Configuração do Banco de Dados PostgreSQL (Production)</h2>

<h3 id="tldr">TL;DR</h3>

<p>PostgreSQL é um sistema gerenciador de banco de dados objeto relacional (SGBDOR), desenvolvido como projeto de código aberto. Hoje, o PostgreSQL é um dos SGBDs (Sistema Gerenciador de Bancos de Dados) de código aberto mais avançados, contando com diversos recursos. O PostgreSQL é compatível com diversos Sistemas Operacionais, dentre eles, o Linux, Windows e Mac OS. Para mais informações acessem o site <a href="https://www.postgresql.org">https://www.postgresql.org</a>.</p>

<h3 id="lets-get-started">Let’s get started</h3>

<p>Neste tutorial você aprenderá a configurar o banco de dados PostgreSQL para uso em produção. Chega de conversa e vamos inciar o tutorial.</p>

<p style="text-align: center;">
  <img src="/assets/images/getstart-underwood.gif" style="width: 50%;" />
</p>

<h3 id="instalação-do-postgresql-9x-no-ubuntu-e-derivados">Instalação do PostgreSQL 9.x no Ubuntu e derivados</h3>

<p>Atualize os repositórios:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo </span>apt-get update</code></pre></figure>

<p>Instale o PostgreSQL:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>postgresql postgresql-contrib</code></pre></figure>

<p>Teste o acesso ao PostgreSQL:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-i</span> <span class="nt">-u</span> postgres
~<span class="nv">$ </span>psql
~# <span class="se">\q</span></code></pre></figure>

<p>Criar, Deletar e Acessar, uma base de dados:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span>createdb mydb
~<span class="nv">$ </span>dropdb mydb
~<span class="nv">$ </span>psql mydb</code></pre></figure>

<p>Alterar a senha do usuário postgres:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-i</span> <span class="nt">-u</span> postgres
~<span class="nv">$ </span>psql <span class="nt">-d</span> postgres <span class="nt">-U</span> postgres psql
~# ALTER USER postgres with PASSWORD <span class="s1">'minha_senha'</span><span class="p">;</span>
~# <span class="se">\q</span>
~<span class="nv">$ </span><span class="nb">exit</span></code></pre></figure>

<p>Reinicie o PostgreSQL:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo </span>service postgresql restart</code></pre></figure>

<p>Adicione o postgres ao grupo sudo:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo </span>gpasswd <span class="nt">-a</span> postgres <span class="nb">sudo</span></code></pre></figure>

<p>Alternar para usuário postgres no terminal como superusuário:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo </span>su - postgres</code></pre></figure>

<p>Crie um novo usuário no postgres:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span> postgres createuser <span class="nt">-d</span> <span class="nt">-R</span> <span class="nt">-P</span> my_user</code></pre></figure>

<p>Crie uma base de dados para o novo usuário:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span> postgres createdb <span class="nt">-O</span> my_user db_test</code></pre></figure>

<p>Entre no postgres com o superusuário:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span>psql <span class="nt">--username</span><span class="o">=</span>postgres <span class="nt">--password</span></code></pre></figure>

<p>Dê permissão para um usuário específico acessar uma determinada base de dados:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~# GRANT ALL PRIVILEGES ON DATABASE db_test TO my_user<span class="p">;</span>
~# <span class="se">\q</span></code></pre></figure>

<p>Entrar no postgres com o novo usuário:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span>psql <span class="nt">--username</span><span class="o">=</span>my_user <span class="nt">--password</span></code></pre></figure>

<h3 id="extra-opcional">Extra (Opcional)</h3>

<h4 id="liberar-acesso-remoto-ao-postgresql">Liberar acesso remoto ao PostgreSQL</h4>

<p>Libere o acesso remoto pela rede ao PostgreSQL (não recomendado para uso em produção):<br />
*substitua o 9.x pelo número de sua versão atual do PostgreSQL<br /></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo </span>nano /etc/postgresql/9.x/main/postgresql.conf</code></pre></figure>

<p>Alterar: <br /></p>

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">de # listen_address = 'localhost'
para listen_address = '*'</code></pre></figure>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo </span>nano /etc/postgresql/9.x/main/pg_hba.conf</code></pre></figure>

<p>Adicione a seguinte linha ao final do arquivo:<br /></p>

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">host all all 0.0.0.0/0 md5</code></pre></figure>

<p>A forma mais correta de configurar o acesso externo ao banco de dados é configurar um proxy para acesso ao banco. Dessa maneira o acesso não ficará disponível abertamente na internet.</p>

<p>Para mais informações recomendo o seguintes links <a href="https://www.postgresql.org/docs/8.2/static/ssh-tunnels.html">01</a> e <a href="https://support.cloud.engineyard.com/hc/en-us/articles/205408088-Access-Your-Database-Remotely-Through-an-SSH-Tunnel">02</a>. Em breve postarei um tutorial ensinando passo a passo como fazer esta configuração.</p>

<h4 id="instalando-o-pgadmin">Instalando o PgAdmin</h4>

<p>Instale o programa PgAdmin3 para gerenciar o banco de dados com uma interface gráfica:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">~<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>pgadmin3 <span class="nt">-y</span></code></pre></figure>

<p>Para mais informações acessem o <a href="https://www.postgresql.org/ftp/pgadmin3/">link</a>.</p>

<h3 id="considerações-finais">Considerações Finais</h3>

<p>Chegamos ao final do tutorial, caso tenha acontecido algum problema favor reportar nos comentários. Caso tudo tenha dado certo chegou a hora de criar suas tabelas e pôr o seu banco de dados no ar. Happy Code :)</p>

<p style="text-align: center;">
  <img src="/assets/images/hasta-la-vista.gif" style="width: 50%;" />
</p>

<h3 id="update">Update</h3>

<p>Foi feito uma pequena correção no tutorial sobre como fazer o acesso remoto ao Banco de Dados, sugestão feita nos comentários do post. Obrigado todos pelo feedback ;)</p>

<h4 id="disclaimer">Disclaimer</h4>

<p>É permitido a reprodução integral desse material desde que sejam feitas as devidas referências ao autor ;)</p>

<h4 id="referências">Referências</h4>

<p>[1] PostgreSQL. <strong><em>PostgreSQL</em></strong>. Acessado em Fevereiro de 2017. Disponível em: <a href="https://www.postgresql.org">https://www.postgresql.org</a>.</p>

<p>[2] PostgreSQL Wikipedia. <strong><em>PostgreSQL Wiki</em></strong>. Acessado em Fevereiro de 2017. Disponível em: <a href="https://pt.wikipedia.org/wiki/PostgreSQL">https://pt.wikipedia.org/wiki/PostgreSQL</a>.</p>

<p>[3] Comunidade Brasileira de PostgreSQL. <strong><em>PostgreSQL Brasil</em></strong>. Acessado em Fevereiro de 2017. Disponível em: <a href="https://www.postgresql.org.br">https://www.postgresql.org.br</a>.</p>
:ET